{#<!DOCTYPE html>#}
{#<html>#}
{#  <head>#}
{#    <meta charset="utf-8">#}
{#    <title>Flask-SimpleMDE example</title>#}
{#    {{ simplemde.css }}#}
{#    {{ simplemde.js }}#}
{#  </head>#}
{#  <body>#}
{#    <form action="/articles/new" method="post">#}
{#    <textarea>#}
{#    –û–±—ã—á–Ω–µ–Ω—å–∫–∏–π —Ç–∞–∫–æ–π —Ç–µ–∫—Å—Ç —Ç—É—Ç#}
{#    </textarea>#}
{#    <button onclick="">Save</button>#}
{#    </form>#}
{#    {{ simplemde.load }}#}
{#  </body>#}
{#  <script src="{{ url_for('static', filename='script.js') }}"></script>#}
{#</html>#}


{% extends 'base.html' %}
{% block content %}
    <div id="editorjs"></div>

    <div class="ce-example__button" id="saveButton">
        editor.save()
    </div>

    <div class="ce-example__statusbar">
        Readonly:
        <b id="readonly-state">
            Off
        </b>
        <div class="ce-example__statusbar-button" id="toggleReadOnlyButton">
            toggle
        </div>
    </div>
    </div>
    <div class="ce-example__output">
        <pre class="ce-example__output-content" id="output"></pre>

    </div>
    </div>

    <!-- Load Tools -->
    <!--
     You can upload Tools to your project's directory and connect them by relative links.
     Also you can load each Tool from CDN or use NPM/Yarn packages.
     Read more at Tools Connection doc:
     https://editorjs.io/getting-started#tools-connection
     -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script><!-- Header -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/simple-image@latest"></script><!-- Image -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/delimiter@latest"></script><!-- Delimiter -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script><!-- List -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/checklist@latest"></script><!-- Checklist -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@latest"></script><!-- Quote -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/code@latest"></script><!-- Code -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/embed@latest"></script><!-- Embed -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script><!-- Table -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/link@latest"></script><!-- Link -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/warning@latest"></script><!-- Warning -->

    <script src="https://cdn.jsdelivr.net/npm/@editorjs/marker@latest"></script><!-- Marker -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/inline-code@latest"></script><!-- Inline Code -->

    <!-- Load Editor.js's Core -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>

    <!-- Initialization -->
    <script>
        async function postData(url = '', data = {}) {
            const response = await fetch(url, {
                method: 'POST', // *GET, POST, PUT, DELETE, etc.
                headers: {
                    'Content-Type': 'application/json'
                    // 'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: JSON.stringify(data) // body data type must match "Content-Type" header
            });
            return await response.json(); // parses JSON response into native JavaScript objects
        }


        let editor = new EditorJS({

            readOnly: false,

            holder: 'editorjs',

            /**
             * Common Inline Toolbar settings
             * - if true (or not specified), the order from 'tool' property will be used
             * - if an array of tool names, this order will be used
             */
            // inlineToolbar: ['link', 'marker', 'bold', 'italic'],
            // inlineToolbar: true,

            /**
             * Tools list
             */
            tools: {
                /**
                 * Each Tool is a Plugin. Pass them via 'class' option with necessary settings {@link docs/tools.md}
                 */
                header: {
                    class: Header,
                    inlineToolbar: ['marker', 'link'],
                    config: {
                        placeholder: 'Header'
                    },
                    shortcut: 'CMD+SHIFT+H'
                },

                /**
                 * Or pass class directly without any configuration
                 */
                image: SimpleImage,

                list: {
                    class: List,
                    inlineToolbar: true,
                    shortcut: 'CMD+SHIFT+L'
                },

                checklist: {
                    class: Checklist,
                    inlineToolbar: true,
                },

                quote: {
                    class: Quote,
                    inlineToolbar: true,
                    config: {
                        quotePlaceholder: 'Enter a quote',
                        captionPlaceholder: 'Quote\'s author',
                    },
                    shortcut: 'CMD+SHIFT+O'
                },

                warning: Warning,

                marker: {
                    class: Marker,
                    shortcut: 'CMD+SHIFT+M'
                },

                code: {
                    class: CodeTool,
                    shortcut: 'CMD+SHIFT+C'
                },

                delimiter: Delimiter,

                inlineCode: {
                    class: InlineCode,
                    shortcut: 'CMD+SHIFT+C'
                },

                linkTool: LinkTool,

                embed: Embed,

                table: {
                    class: Table,
                    inlineToolbar: true,
                    shortcut: 'CMD+ALT+T'
                },

            },

            /**
             * This Tool will be used as default
             */
            defaultBlock: 'paragraph',

            i18n: {
                /**
                 * @type {I18nDictionary}
                 */
                messages: {
                    /**
                     * Other below: translation of different UI components of the editor.js core
                     */
                    ui: {
                        "blockTunes": {
                            "toggler": {
                                "Click to tune": "–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å",
                                "or drag to move": "–∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ"
                            },
                        },
                        "inlineToolbar": {
                            "converter": {
                                "Convert to": "–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤"
                            }
                        },
                        "toolbar": {
                            "toolbox": {
                                "Add": "–î–æ–±–∞–≤–∏—Ç—å"
                            }
                        }
                    },

                    /**
                     * Section for translation Tool Names: both block and inline tools
                     */
                    toolNames: {
                        "Text": "–ü–∞—Ä–∞–≥—Ä–∞—Ñ",
                        "Heading": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
                        "List": "–°–ø–∏—Å–æ–∫",
                        "Warning": "–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ",
                        "Checklist": "–ß–µ–∫–ª–∏—Å—Ç",
                        "Quote": "–¶–∏—Ç–∞—Ç–∞",
                        "Code": "–ö–æ–¥",
                        "Delimiter": "–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å",
                        "Raw HTML": "HTML-—Ñ—Ä–∞–≥–º–µ–Ω—Ç",
                        "Table": "–¢–∞–±–ª–∏—Ü–∞",
                        "Link": "–°—Å—ã–ª–∫–∞",
                        "Marker": "–ú–∞—Ä–∫–µ—Ä",
                        "Bold": "–ü–æ–ª—É–∂–∏—Ä–Ω—ã–π",
                        "Italic": "–ö—É—Ä—Å–∏–≤",
                        "InlineCode": "–ú–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π",
                    },

                    /**
                     * Section for passing translations to the external tools classes
                     */
                    tools: {
                        /**
                         * Each subsection is the i18n dictionary that will be passed to the corresponded plugin
                         * The name of a plugin should be equal the name you specify in the 'tool' section for that plugin
                         */
                        "warning": { // <-- 'Warning' tool will accept this dictionary section
                            "Title": "–ù–∞–∑–≤–∞–Ω–∏–µ",
                            "Message": "–°–æ–æ–±—â–µ–Ω–∏–µ",
                        },

                        /**
                         * Link is the internal Inline Tool
                         */
                        "link": {
                            "Add a link": "–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É"
                        },
                        /**
                         * The "stub" is an internal block tool, used to fit blocks that does not have the corresponded plugin
                         */
                        "stub": {
                            'The block can not be displayed correctly.': '–ë–ª–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω'
                        }
                    },

                    /**
                     * Section allows to translate Block Tunes
                     */
                    blockTunes: {
                        /**
                         * Each subsection is the i18n dictionary that will be passed to the corresponded Block Tune plugin
                         * The name of a plugin should be equal the name you specify in the 'tunes' section for that plugin
                         *
                         * Also, there are few internal block tunes: "delete", "moveUp" and "moveDown"
                         */
                        "delete": {
                            "Delete": "–£–¥–∞–ª–∏—Ç—å"
                        },
                        "moveUp": {
                            "Move up": "–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–≤–µ—Ä—Ö"
                        },
                        "moveDown": {
                            "Move down": "–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤–Ω–∏–∑"
                        }
                    },
                }
            },

            /**
             * Initial Editor data
             */
            data: {
                blocks: [
                    {
                        type: "header",
                        data: {
                            text: "–ì–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–∫—Å—Ç–∞",
                            level: 1
                        }
                    },
                    {
                        type: 'paragraph',
                        data: {
                            text: '–ê —ç—Ç–æ —É–∂–µ –æ–±—ã—á–Ω—ã–π –∞–±–∑–∞—Ü'
                        }
                    },
                    {
                        type: "header",
                        data: {
                            text: "–ù–µ —Ç–∞–∫–æ–π –∫—Ä—É—Ç–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, –Ω–æ —Ç–æ–∂–µ –Ω–∏—á–µ–≥–æ",
                            level: 3
                        }
                    },
                    {
                        type: 'list',
                        data: {
                            items: [
                                '–≠—Ç–∞ —à—Ç—É–∫–∞ —Ç–æ–∂–µ –æ–≥–æ–Ω—åüî•üî•üî•',
                                '–ó–≤–∞—Ç—å –Ω–µ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫',
                                '–£–¥–æ–±–Ω–æ —á—Ç–æ-—Ç–æ —Ç—É—Ç –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å',
                            ],
                            style: 'unordered'
                        }
                    },
                    {
                        type: 'delimiter',
                        data: {}
                    },
                    {
                        type: 'paragraph',
                        data: {
                            text: '–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –º–Ω–æ–≥–æ —á–µ–≥–æ –Ω–∞–≤–æ—Ä–æ—Ç–∏—Ç—å. –ü—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ–∏–≥—Ä–∞—Ç—å—Å—è —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æüòè'
                        }
                    },
                    {
                        type: 'image',
                        data: {
                            url: 'static/img/content.png',
                            caption: '–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏',
                            stretched: false,
                            withBorder: true,
                            withBackground: false,
                        }
                    },
                ]
            },
            onReady: function () {
                saveButton.click();
            },
            onChange: function () {
                console.log('something changed');
            }
        });

        /**
         * Saving button
         */
        const saveButton = document.getElementById('saveButton');

        /**
         * Toggle read-only button
         */
        const toggleReadOnlyButton = document.getElementById('toggleReadOnlyButton');
        const readOnlyIndicator = document.getElementById('readonly-state');

        /**
         * Saving example
         */
        saveButton.addEventListener('click', function () {
            editor.save().then((outputData) => {
                postData('/articles/new/{{ article_id }}', outputData).then((data) => {
                    console.log(data); // JSON data parsed by `response.json()` call
                });
            }).catch((error) => {
                console.log('Saving failed: ', error)
            });
        });


        /**
         * Toggle read-only example
         */
        toggleReadOnlyButton.addEventListener('click', async () => {
            const readOnlyState = await editor.readOnly.toggle();

            readOnlyIndicator.textContent = readOnlyState ? 'On' : 'Off';
        });

    </script>
    </body>
    </html>

{% endblock %}